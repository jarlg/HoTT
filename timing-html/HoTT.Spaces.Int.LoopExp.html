<html>
<head>
<title>LoopExp.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for LoopExp.v</h1>

<div class="code" title="File: LoopExp.v
Line: 1
Time: 0.018s">
<div class="time" style="width: 90%"></div>
<pre>Require Import Basics.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 1
Time: 0.014s">
<div class="time" style="width: 70%"></div>
<pre>
Require Import Types.Universe.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 2
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import Spaces.Pos.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 3
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
Require Import Spaces.Int.Core.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import Spaces.Int.Spec.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import Spaces.Int.Equiv.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope positive_scope.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope int_scope.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Exponentiation of loops *)

</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition loopexp_pos {A : Type} {x : A} (p : x = x) (n : Pos) : (x = x).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 13
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert n.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 14
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  serapply pos_peano_ind.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 15
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 16
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact p.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 16
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 17
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros n q.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 17
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (q @ p).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 18
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 19
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>

Definition loopexp {A : Type} {x : A} (p : x = x) (z : Int) : (x = x)
  := match z with
       | neg n =&gt; loopexp_pos p^ n
       | zero =&gt; 1
       | pos n =&gt; loopexp_pos p n
     end.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma loopexp_pos_inv {A : Type} {x : A} (p : x = x) (n : Pos)
  : loopexp_pos p^ n = (loopexp_pos p n)^.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 29
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert n.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 31
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>
  serapply pos_peano_ind; cbn; trivial.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold loopexp_pos.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros n q.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 34
Time: 0.006s">
<div class="time" style="width: 30%"></div>
<pre>
  rewrite 2 pos_peano_ind_beta_pos_succ, q.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine ((inv_pp _ _)^ @ _).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 36
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply ap.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  clear q.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert n.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 39
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
  serapply pos_peano_ind; cbn; trivial.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros n q.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 41
Time: 0.003s">
<div class="time" style="width: 15%"></div>
<pre>
  by rewrite pos_peano_ind_beta_pos_succ, concat_p_pp, q.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 42
Time: 0.005s">
<div class="time" style="width: 25%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 43
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>

Definition ap_loopexp_pos {A B} (f : A -&gt; B) {x : A} (p : x = x) (n : Pos)
  : ap f (loopexp_pos p n) = loopexp_pos (ap f p) n.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert n.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 48
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>
  serapply pos_peano_ind; cbn; trivial.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold loopexp_pos.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros n q.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 51
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>
  rewrite 2 pos_peano_ind_beta_pos_succ.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 52
Time: 0.003s">
<div class="time" style="width: 15%"></div>
<pre>
  by rewrite ap_pp, q.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 53
Time: 0.003s">
<div class="time" style="width: 15%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition ap_loopexp {A B} (f : A -&gt; B) {x : A} (p : x = x) (z : Int)
: ap f (loopexp p z) = loopexp (ap f p) z.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct z as [n| |n]; trivial.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> cbn.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 60
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>
    rewrite loopexp_pos_inv, ap_V, loopexp_pos_inv.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ap.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ap_loopexp_pos.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 63
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap_loopexp_pos.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 64
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma int_add_succ_l a b : int_succ a + b = int_succ (a + b).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 67
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 68
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  rewrite &lt;- int_add_assoc, (int_add_comm 1 b).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply int_add_assoc.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 71
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma int_add_succ_r a b : a + int_succ b = int_succ (a + b).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply int_add_assoc.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma int_add_pred_l a b : int_pred a + b = int_pred (a + b).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 79
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
  rewrite &lt;- int_add_assoc, (int_add_comm (-1) b).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply int_add_assoc.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma int_add_pred_r a b : a + int_pred b = int_pred (a + b).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply int_add_assoc.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 86
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 87
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>

Lemma loopexp_pos_concat {A : Type} {x : A} (p : x = x) (a : Pos)
  : loopexp_pos p a @ p = p @ loopexp_pos p a.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction a as [|a aH] using pos_peano_ind; trivial.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold loopexp_pos.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  rewrite pos_peano_ind_beta_pos_succ.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 94
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
  change ((loopexp_pos p a @ p) @ p = p @ (loopexp_pos p a @ p)).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 95
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>
  by rewrite concat_p_pp, aH.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 96
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 97
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>

Lemma loopexp_pos_add {A : Type} {x : A} (p : x = x) (a b : Pos)
  : loopexp_pos p (a + b)%pos = loopexp_pos p a @ loopexp_pos p b.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert a b.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 102
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>
  induction a as [|a aH] using pos_peano_ind;
  induction b as [|b bH] using pos_peano_ind;
  trivial.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 106
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre> rewrite pos_add_1_l in *.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold loopexp_pos.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 107
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
    rewrite pos_peano_ind_beta_pos_succ.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    change (loopexp_pos p (pos_succ b) @ p
      = p @ loopexp_pos p (pos_succ b)).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 110
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
    rewrite bH; cbn.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 111
Time: 0.003s">
<div class="time" style="width: 15%"></div>
<pre>
    by rewrite concat_pp_p, loopexp_pos_concat.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 113
Time: 0.003s">
<div class="time" style="width: 15%"></div>
<pre> rewrite pos_add_1_r in *.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold loopexp_pos.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 114
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
    by rewrite pos_peano_ind_beta_pos_succ.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 116
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite pos_add_succ_l.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 116
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold loopexp_pos.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 117
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
    rewrite 2 pos_peano_ind_beta_pos_succ.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 118
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
    change (loopexp_pos p (a + pos_succ b)%pos @ p
      = (loopexp_pos p a @ p) @ loopexp_pos p (pos_succ b)).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 120
Time: 0.005s">
<div class="time" style="width: 25%"></div>
<pre>
    by rewrite aH, 2 concat_pp_p, loopexp_pos_concat.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 121
Time: 0.006s">
<div class="time" style="width: 30%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 122
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>


Lemma loopexp_int_pos_sub_l {A : Type} {x : A} (p : x = x) (a b : Pos)
  : loopexp p (int_pos_sub a b) = loopexp_pos p^ b @ loopexp_pos p a.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 127
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  symmetry.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 128
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert a b.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 129
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
  induction a as [|a aH] using pos_peano_ind;
  induction b as [|b bH] using pos_peano_ind.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 132
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply concat_Vp.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 132
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> cbn; rewrite int_pos_sub_succ_r.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold loopexp_pos.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 134
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite pos_peano_ind_beta_pos_succ.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 135
Time: 0.003s">
<div class="time" style="width: 15%"></div>
<pre>
    by rewrite concat_pp_p, concat_Vp, concat_p1.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 136
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 137
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre> rewrite int_pos_sub_succ_l; cbn.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold loopexp_pos.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 138
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
    rewrite pos_peano_ind_beta_pos_succ.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 139
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>
    rewrite loopexp_pos_concat.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 140
Time: 0.003s">
<div class="time" style="width: 15%"></div>
<pre>
    by rewrite concat_p_pp, concat_Vp, concat_1p.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 142
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre> rewrite int_pos_sub_succ_succ.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold loopexp_pos.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 143
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
    rewrite 2 pos_peano_ind_beta_pos_succ.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 144
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
    change ((loopexp_pos p^ b @ p^) @ (loopexp_pos p a @ p)
      = loopexp p (int_pos_sub a b)).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 146
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
    rewrite (loopexp_pos_concat p).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 147
Time: 0.003s">
<div class="time" style="width: 15%"></div>
<pre>
    rewrite concat_pp_p, (concat_p_pp p^ p).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 148
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>
    rewrite concat_Vp, concat_1p.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply aH.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 150
Time: 0.007s">
<div class="time" style="width: 35%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 151
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>

Lemma loopexp_int_pos_sub_r {A : Type} {x : A} (p : x = x) (a b : Pos)
  : loopexp p (int_pos_sub a b) = loopexp_pos p a @ loopexp_pos p^ b.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  symmetry.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 156
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert a b.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 157
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
  induction a as [|a aH] using pos_peano_ind;
  induction b as [|b bH] using pos_peano_ind.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply concat_pV.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 161
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre> cbn; rewrite int_pos_sub_succ_r.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold loopexp_pos.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 162
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite pos_peano_ind_beta_pos_succ.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 163
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
    change (p @ (loopexp_pos p^ b @ p^) = loopexp p (neg b)).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 164
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
    rewrite loopexp_pos_concat.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 165
Time: 0.003s">
<div class="time" style="width: 15%"></div>
<pre>
    by rewrite concat_p_pp, concat_pV, concat_1p.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite int_pos_sub_succ_l; cbn.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold loopexp_pos.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 168
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
    rewrite pos_peano_ind_beta_pos_succ.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 169
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
    change ((loopexp_pos p a @ p) @ p^ = loopexp_pos p a).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 170
Time: 0.003s">
<div class="time" style="width: 15%"></div>
<pre>
    by rewrite concat_pp_p, concat_pV, concat_p1.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 171
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite int_pos_sub_succ_succ.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold loopexp_pos.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 173
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
    rewrite 2 pos_peano_ind_beta_pos_succ.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 174
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
    change ((loopexp_pos p a @ p) @ (loopexp_pos p^ b @ p^)
      = loopexp p (int_pos_sub a b)).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 176
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
    rewrite (loopexp_pos_concat p^).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 177
Time: 0.003s">
<div class="time" style="width: 15%"></div>
<pre>
    rewrite concat_pp_p, (concat_p_pp p p^).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 178
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>
    rewrite concat_pV, concat_1p.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply aH.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 180
Time: 0.007s">
<div class="time" style="width: 35%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 181
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>

Lemma loopexp_add {A : Type} {x : A} (p : x = x) a b
  : loopexp p (a + b) = loopexp p a @ loopexp p b.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 185
Time: 0.01s">
<div class="time" style="width: 50%"></div>
<pre>
  destruct a as [a| |a], b as [b| |b]; trivial;
  try apply loopexp_pos_add; cbn.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 187
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
  1,6: symmetry; apply concat_p1.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 188
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
  2,3: symmetry; apply concat_1p.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: apply loopexp_int_pos_sub_l.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 190
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply loopexp_int_pos_sub_r.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 191
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Under univalence, exponentiation of loops corresponds to iteration of autoequivalences. *)

</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 195
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>Definition equiv_path_loopexp `{Univalence}
           {A : Type} (p : A = A) (z : Int) (a : A)
  : equiv_path A A (loopexp p z) a = int_iter (equiv_path A A p) z a.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 197
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 198
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
  destruct z as [n| |n]; trivial.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 199
Time: 0.02s">
<div class="time" style="width: 100%"></div>
<pre>
  all: induction n as [|n IH]
    using pos_peano_ind; try reflexivity; cbn in *.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 201
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
  all: unfold loopexp_pos; rewrite pos_peano_ind_beta_pos_succ.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 202
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>
  all: unfold pos_iter; rewrite pos_peano_ind_beta_pos_succ.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 203
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>
  all: refine (transport_pp _ _ _ _ @ _); cbn; apply ap, IH.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 204
Time: 0.006s">
<div class="time" style="width: 30%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 205
Time: 0.002s">
<div class="time" style="width: 10%"></div>
<pre>

Definition loopexp_path_universe `{Univalence}
           {A : Type} (f : A &lt;~&gt; A) (z : Int) (a : A)
  : transport idmap (loopexp (path_universe f) z) a
  = int_iter f z a.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert f.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 212
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre> equiv_intro (equiv_path A A) p.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 212
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (_ @ equiv_path_loopexp p z a).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (ap (fun q =&gt; equiv_path A A (loopexp q z) a) _).</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply eissect.</pre>
</div>
<div class="code" title="File: LoopExp.v
Line: 215
Time: 0.001s">
<div class="time" style="width: 5%"></div>
<pre>
Defined.</pre>
</div>
</body>
</html>

